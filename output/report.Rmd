---
title: "Class Excercise 1"
author: "Miguel, Patrick Stöckli, Tobias Hoesli"
date: "`r Sys.Date()`"
output:
  pdf_document:
    extra_dependencies: "subfig"
urlcolor: 'blue'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

## Introduction

For this excersise we will be using the dataset **Quality of Governnment** Dataset.
Data from 1946 to 2021 with a country-year unit of analysis are available in a Basic Time Series (TS) dataset provided by the Quality of Government (QoG) Institute at the University of Gothenburg. The dataset contains both historical and contemporary versions of various nations. Data for nations prior to their independence is excluded, and factors with sparse coverage are eliminated. Basic descriptive numbers and a bar graph showing the availability of data for each year are provided in the codebook.
You can find the codebook [here](https://github.com/UniLuFS2020-ReplicationSeminar/Data_Mining_EX1/blob/f8314e3e5aef74dd7a3f3a26b7e0ffe7b2a4d3c3/data/codebook_bas_jan22.pdf).


### Research Questions

Based on the dataset we wanted to compose the following research questions:

1. Is there a relationship between the level of democracy and the share of women in lower and single houses of parliament?
2. How does the percentage of adherents to Islam in a country affect the share of women in lower and single houses of parliament?
3. Does real GDP per capita have an impact on the share of women in lower and single houses of parliament?


### Empirical Hypotheses

Higher degrees of democracy may lead to more open political structures and, as a result, a higher proportion of women in lower and single houses of parliament. We hypothesize that greater levels of democracy will result in a higher proportion of women serving in the lower and single houses of parliament.
  
The proportion of women in the lower and single houses of parliament may be lower in nations with greater percentages of Muslims due to cultural or religious norms that restrict women's involvement in politics. We therefore hypothesize that there will be fewer women in lower and single houses of parliament in nations with greater rates of Islamic adherents.

## Methods 


### Visualizations

We wanted to examine how women are represented in parliament across various political systems and nations in these charts. In the first plot, which is a boxplot, the percentage of women in lower and single chambers of parliament across nations is visually summarized. For nations where the share of women in parliament is higher than 40%, the second plot—a scatter plot—looks at the connection between the degree of democracy and the proportion of women in the lower and single houses of parliament. We can differentiate between countries and look for a correlation between these two variables by coloring the points according to the names of the countries.  
These viusalizations offer insights into the representation of women in politics across different countries and political systems.

```{r, echo=FALSE}

source("../code/visualization.R")

```

```{r Plots Exploration ,echo=FALSE, warning=FALSE, message= FALSE, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

plot_box_women
plot_point_women

```


### Regressionanalysis

This research utilizes linear regression to evaluate the link between the proportion of women in parliament (lower and single houses) and a number of independent factors, including the percentage of Muslims, the degree of democracy, and real GDP per capita, from the data ts dataset for the year 2010. Using R's lm() function, three linear regression models are estimated. The stargazer() method is then used to depict the outcomes of these regressions. This function creates a table with the coefficients, standard errors, R-squared values, and number of observations for each independent variable.


```{r Load TS Data and Regressions, warning=FALSE, message=FALSE}

source("../code/regression.R")

```


```{r Regression side by side, echo=FALSE, warning=FALSE, message= FALSE, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))
#Level of Democracy 
ggplot(data_ts_2, aes(x = fh_ipolity2, y = ipu_l_sw)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Level of Democracy (Freedom House/Imputed Polity)", y = "Share of Women (Lower and Single Houses)")+
  ggtitle("Regression Analysis by Level of Democracy")


#Islam: Total (%Adherents)
ggplot(data_ts_2, aes(x = arda_isgenpct, y = ipu_l_sw)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Islam: Total (% Adherents)s", y = "Share of Women (Lower and Single Houses)")+
  ggtitle("Regression Analysis by % of adherents to Islam")

```

```{r Part 2 Regressions, echo=FALSE,warning=FALSE, message= FALSE, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))
#Real GDP per Capita
ggplot(data_ts_2, aes(x = mad_gdppc, y = ipu_l_sw)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "GDP per Capita", y = "Share of Women (Lower and Single Houses)")+
  ggtitle("Regression Analysis by GPD per Capita")
# All independent variables 
ggplot(data_ts_2, aes(x = arda_isgenpct+fh_ipolity2+mad_gdppc, y = ipu_l_sw)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Independent Variables", y = "Share of Women (Lower and Single Houses)")+
  ggtitle("Regression Analysis by All Independent Variables")



```
  

```{r Stargazer Regressionanalysis, echo=FALSE, results='asis'}
#Load package "labelled" to generate table
library(stargazer)

#Generate a well-formatted table
stargazer(regression_a, regression_b, regression_c, 
          title="Regression on the Share of Women in Parliament (Lower and Single Houses) ", 
          dep.var.caption="", 
          dep.var.labels.include=FALSE,
          covariate.labels=c("Islam","Level of Democracy", "Real GDP per Capita"), 
          digits=2,
          keep.stat=c("rsq", "adj.rsq", "n"), 
          notes=c("Notes: Standard errors in parentheses."), 
          notes.align = "c", 
          notes.label="",
          no.space=TRUE,
          type = 'latex')
```

\newpage

## Results  

Islam has a statistically significant negative connection with the proportion of women in parliament in all three models. This indicates that there are fewer women in parliament in nations with higher levels of Islam. The real GDP per capita and democracy level factors are not statistically significant.
Low R-squared values for all three models suggest that they do not adequately account for the variation in the dependent variable.  

As a result of this analysis, it can be concluded that there is evidence to support the notion that nations with higher levels of Islam have a lower proportion of women in parliament.
However, With this data alone we cannot conclude that Islam is the only, nor the biggest factor that has influence on the above mentioned points.
